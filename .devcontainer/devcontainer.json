{
  "name": "dotfiles",
  "initializeCommand": [
    "bash", "-c", "eval $*", "--",
    "echo $DOTFILES_DEVCONTAINER_INITIALIZE | docker login ghcr.io --username $GITHUB_USER --password-stdin",
    "&& export DEVCONTAINER_IMAGE=dotfiles-devcontainer",
    "&& export DEVCONTAINER_REGISTRY=ghcr.io/rcwbr",
    "&& export DEVCONTAINER_DEFINITION_TYPE=bake",
    "&& export DEVCONTAINER_DEFINITION_FILES=\"cwd://.devcontainer/devcontainer-bake.hcl useradd/devcontainer-bake.hcl pre-commit/devcontainer-bake.hcl\"",
    "&& export DEVCONTAINER_BUILD_ADDITIONAL_ARGS=https://github.com/rcwbr/dockerfile-partials.git#2-define-pre-commit-dockerfile-partial",
    "&& curl https://raw.githubusercontent.com/rcwbr/devcontainer-cache-build/1-define-initialize-script-with-caching-logic/initialize | bash"
  ],
  "image": "dotfiles-devcontainer",
  "features": {
    "ghcr.io/devcontainers/features/docker-outside-of-docker:1": {}
  },
  "secrets": {
    "DOTFILES_DEVCONTAINER_INITIALIZE": {
      "description": "GitHub personal access token with `write:packages` scope to pull and push devcontainer image cache",
      "documentationUrl": "https://github.com/rcwbr/devcontainer-cache-build/blob/main/README.md#initialize-script-github-container-registry-setup"
    }
  }
}
